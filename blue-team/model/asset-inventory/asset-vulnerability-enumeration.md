# Asset Vulnerability Enumeration

## Cheat Sheet

### Network Discovery

#### [Netdiscover](https://github.com/netdiscover-scanner/netdiscover)

{% hint style="info" %}
Scan for Find IPs
{% endhint %}

```bash
sudo netdiscover > /tmp/netdiscover.txt
```

#### [Naabu](https://github.com/projectdiscovery/naabu)

{% hint style="info" %}
Scan for Find Ports
{% endhint %}

```bash
naabu -list /tmp/netdiscover.txt \
      -p - -udp -c 200 \
      -rate 1000 \
      -o /tmp/naabu.txt
```

#### [Nmap](https://nmap.org/download)

{% hint style="info" %}
Scan IPs and Fingerprint Protocols
{% endhint %}

```bash
nmap -iL /tmp/naabu.txt \
     --mtu 5000 -sV -sC -O -T4 -Pn \
     -oX /tmp/nmap.xml
```

{% hint style="info" %}
Scan Vulnerabilities
{% endhint %}

```bash
nmap -iL /tmp/naabu.txt \
     -sS -sU -sV -sC -A -T4 -O --mtu 5000 -Pn \
     --script="ssl-*,ftp-*,http-*,http-webdav-*,smtp-*,snmp-*,smb-*,imap-*,pop3-*,rdp-*,redis-*,memcached-*" \     
     -oX /tmp/nmap.xml
```

#### [Nuclei](https://github.com/projectdiscovery/nuclei)

{% hint style="info" %}
Misconfiguration & Vulnerabilities
{% endhint %}

```bash
nuclei -im /tmp/nmap.xml \
       -tags network,tcp,udp,dns,ssl,ftp,ssh,rdp,smb,mysql,postgres,redis,mongodb,vnc,oracle,default-login,misconfiguration,exposure \
       -o /tmp/nuclei.txt
```

### SSL/TLS

#### [testssl.sh](https://github.com/testssl/testssl.sh)

{% hint style="info" %}
Test SSL/TLS vulnerabilities on a single host
{% endhint %}

```bash
testssl $TARGET
```

{% hint style="info" %}
Test SSL/TLS vulnerabilities on a Subnet
{% endhint %}

```bash
testssl 192.168.1.0/24
```

{% hint style="info" %}
Test SSL/TLS server implementation bugs
{% endhint %}

```bash
testssl --full $TARGET
```

### FTP

#### [Metasploit](https://github.com/rapid7/metasploit-framework)

{% hint style="info" %}
Version Reconnaissance
{% endhint %}

```bash
msfconsole -qx "
    use auxiliary/scanner/ftp/ftp_version;
    set RHOSTS $WEBSITE;
    run;
    exit"
```

{% hint style="info" %}
Anonymous Login
{% endhint %}

```bash
msfconsole -qx "
    use auxiliary/scanner/ftp/anonymous;
    set RHOSTS $WEBSITE;
    run;
    exit"
```

### WebDAV

#### [Metasploit](https://github.com/rapid7/metasploit-framework)

{% hint style="info" %}
Scan WebDAV
{% endhint %}

```bash
msfconsole -qx "
    use auxiliary/scanner/http/webdav_scanner;
    set PATH /webdav;
    set RHOSTS $WEBSITE;
    exit"
```

#### [davtest](https://gitlab.com/kalilinux/packages/davtest)

{% hint style="info" %}
Scan WebDAV
{% endhint %}

```bash
davtest -url $WEBSITE
```

### SNMP

#### [Metasploit](https://github.com/rapid7/metasploit-framework)

{% hint style="info" %}
Enumerate SNMP Public
{% endhint %}

```bash
msfconsole -qx "
    use auxiliary/scanner/snmp/snmp_enum;
    set RHOSTS $WEBSITE;
    run;
    exit"
```

{% hint style="info" %}
Enumerate Windows Users
{% endhint %}

```bash
msfconsole -qx "
    use auxiliary/scanner/snmp/snmp_enumusers;
    set RHOSTS $WEBSITE;
    run;
    exit"
```

{% hint style="info" %}
Enumerate File Shares
{% endhint %}

```bash
msfconsole -qx "
    use auxiliary/scanner/snmp/snmp_enumshares;
    set RHOSTS $WEBSITE;
    run;
    exit"
```

### SMB

#### [Metasploit](https://github.com/rapid7/metasploit-framework)

{% hint style="info" %}
Credential Brute Force
{% endhint %}

```bash
msfconsole -qx "
    use auxiliary/scanner/smb/smb_login;
    set RHOSTS $TARGET;
    set SMBUser Administrator;
    set PASS_FILE /usr/share/seclists/Passwords/Default-Credentials/default-passwords.txt;
    set STOP_ON_SUCCESS true;
    set ANONYMOUS_LOGIN true;
    set THREADS 10;
    run;
    exit"
```

{% hint style="info" %}
Detect EternalBlue
{% endhint %}

```bash
msfconsole -qx "
    use auxiliary/scanner/smb/smb_ms17_010;
    set RHOSTS $TARGET;
    run;
    exit"
```

### Redis

#### [Metasploit](https://github.com/rapid7/metasploit-framework)

{% hint style="info" %}
Redis Misconfiguration Check
{% endhint %}

```bash
msfconsole -qx "use auxiliary/gather/redis_extractor;
    set RHOSTS $TARGET;
    run;
    exit"
```
