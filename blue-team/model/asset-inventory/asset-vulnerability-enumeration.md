# Asset Vulnerability Enumeration

## Cheat Sheet

### Network Discovery

#### [Netdiscover](https://github.com/netdiscover-scanner/netdiscover)

{% hint style="info" %}
Scan for Find IPs
{% endhint %}

```bash
sudo netdiscover > /tmp/netdiscover.txt
```

#### [Naabu](https://github.com/projectdiscovery/naabu)

{% hint style="info" %}
Scan for Find Ports
{% endhint %}

```bash
naabu -list /tmp/netdiscover.txt \
      -p - -udp -c 200 \
      -rate 1000 -timeout 3000 \
      -retries 2 -silent \
      -o /tmp/naabu.txt
```

#### [Nmap](https://nmap.org/download)

{% hint style="info" %}
Scan IPs and Fingerprint Protocols
{% endhint %}

```bash
nmap -iL /tmp/naabu.txt \
     --mtu 5000 -sV -sC -O -Pn -T4 \
     -oX /tmp/nmap.xml
```

#### [Nuclei](https://github.com/projectdiscovery/nuclei)

{% hint style="info" %}
Misconfiguration & Vulnerabilities
{% endhint %}

```bash
nuclei -im /tmp/nmap.xml \
       -tags network,tcp,udp,dns,ssl,ftp,ssh,rdp,smb,mysql,postgres,redis,mongodb,vnc,oracle,default-login,misconfiguration,exposure \
       -o /tmp/nuclei.txt
nuclei -l /tmp/ips.txt \
       -tags network,tcp,udp,dns,ssl,ftp,ssh,rdp,smb,mysql,postgres,redis,mongodb,vnc,oracle,default-login,misconfiguration,exposure \
       -severity critical,high,medium \
       -type tcp,udp \
       -c 300 \
       -rate-limit 3000 \
       -bulk-size 500 \
       -timeout 5 \
       -retries 2 \
       -stats \
       -silent \
       -o /tmp/internal-scan.txt
```

### SSL/TLS

#### [Nmap](https://nmap.org/)

{% hint style="info" %}
Enumerate SSL ciphers
{% endhint %}

```bash
nmap --mtu 5000 \
     --script ssl-enum-ciphers \
     -p 443 $DOMAIN
```

{% hint style="info" %}
Enumerate SSL vulnerabilities
{% endhint %}

<pre class="language-bash"><code class="lang-bash">nmap --mtu 5000 \
     --script=ssl-ccs-injection.nse,ssl-heartbleed.nse,ssl-known-key.nse,ssl-poodle.nse,sslv2-drown.nse \
<strong>     -p 443 $DOMAIN
</strong></code></pre>

#### [testssl.sh](https://github.com/testssl/testssl.sh)

{% hint style="info" %}
Test SSL/TLS vulnerabilities on a single host
{% endhint %}

```bash
testssl $TARGET
```

{% hint style="info" %}
Test SSL/TLS vulnerabilities on a Subnet
{% endhint %}

```bash
testssl 192.168.1.0/24
```

{% hint style="info" %}
Test SSL/TLS server implementation bugs
{% endhint %}

```bash
testssl --full $TARGET
```

### FTP

#### [Nmap](https://nmap.org/)

{% hint style="info" %}
Detect ftp vulnerabilities
{% endhint %}

<pre class="language-bash"><code class="lang-bash">nmap -sS -sV --mtu 5000 \
     --script=ftp-anon,ftp-brute,ftp-vuln-cve2010-4221.nse,ftp-vsftpd-backdoor.nse,ftp-proftpd-backdoor.nse \
<strong>     -p 21 $TARGET
</strong></code></pre>

#### [Hydra](https://github.com/vanhauser-thc/thc-hydra)

{% hint style="info" %}
Brute Force
{% endhint %}

```bash
hydra -V \
      -L /usr/share/seclists/Usernames/sap-default-usernames.txt \
      -P /usr/share/seclists/Passwords/darkweb2017-top10000.txt ftp://$TARGET:21
```

#### [Metasploit](https://github.com/rapid7/metasploit-framework)

{% hint style="info" %}
Version Reconnaissance
{% endhint %}

```bash
msfconsole -qx "
    use auxiliary/scanner/ftp/ftp_version;
    set RHOSTS $WEBSITE;
    run;
    exit"
```

{% hint style="info" %}
Anonymous Login
{% endhint %}

```bash
msfconsole -qx "
    use auxiliary/scanner/ftp/anonymous;
    set RHOSTS $WEBSITE;
    run;
    exit"
```

{% hint style="info" %}
Brute Force
{% endhint %}

```bash
msfconsole -qx "
    use auxiliary/scanner/ftp/ftp_login;
    set RHOSTS $WEBSITE;
    set USERPASS_FILE /usr/share/seclists/Passwords/Default-Credentials/ftp-betterdefaultpasslist.txt;
    run;
    exit"
```

### HTTP

#### [Nmap](https://nmap.org/)

{% hint style="info" %}
Detect http service vulnerabilities
{% endhint %}

```bash
nmap -sS -sV --mtu 5000 \
--script=http-vuln-*,http-huawei-hg5xx-vuln.nse,http-iis-webdav-vuln.nse,http-vmware-path-vuln.nse,mysql-vuln-cve2012-2122.nse \
-p 80 $TARGET
```

### WebDAV

#### [Nmap](https://nmap.org/)

{% hint style="info" %}
Scan WebDAV
{% endhint %}

```bash
nmap -p 80,443 \
     -sS -sV --mtu 5000 \
     --script http-methods,http-webdav-scan $TARGET
```

#### [Metasploit](https://github.com/rapid7/metasploit-framework)

{% hint style="info" %}
Scan WebDAV
{% endhint %}

```bash
msfconsole -qx "
    use auxiliary/scanner/http/webdav_scanner;
    set PATH /webdav;
    set RHOSTS $WEBSITE;
    exit"
```

#### [Hydra](https://github.com/vanhauser-thc/thc-hydra)

{% hint style="info" %}
Brute Force
{% endhint %}

<pre class="language-bash"><code class="lang-bash">hydra -V \
      -L /usr/share/seclists/Usernames/sap-default-usernames.txt \
<strong>      -P /usr/share/seclists/Passwords/darkweb2017-top10000.txt \
</strong>      $TARGET http-get /webdav/
</code></pre>

#### [davtest](https://gitlab.com/kalilinux/packages/davtest)

{% hint style="info" %}
Scan WebDAV
{% endhint %}

```bash
davtest -url $WEBSITE
```

### SMTP

#### [Nmap](https://nmap.org/)

{% hint style="info" %}
Detect smtp vulnerabilities
{% endhint %}

```bash
nmap -sS -sV --mtu 5000 \
--script=smtp-vuln-*,smtp-open-relay,smtp-brute \
-p 25,465,587 $TARGET
```

{% hint style="info" %}
Enumerate SMTP server users
{% endhint %}

```bash
nmap --script smtp-enum-users.nse \
--script-args=smtp-enum-users.methods={EXPN,RCPT,VRFY} \
-p 25,465,587 $TARGET
```

### SNMP

#### [Nmap](https://nmap.org/)

{% hint style="info" %}
Brute Force
{% endhint %}

```bash
nmap -p 161 -sU -sV --mtu 5000 --script snmp-brute $TARGET
```

#### [Nuclei](https://github.com/projectdiscovery/nuclei)

{% hint style="info" %}
Misconfiguration & Vulnerabilities
{% endhint %}

```bash
nuclei -tags snmp -u $TARGET:161
```

#### [SNMPWalk](https://linux.die.net/man/1/snmpwalk)

{% hint style="info" %}
Enumerate SNMPv1 Public
{% endhint %}

```bash
snmpwalk -v1 -c public $TARGET
```

{% hint style="info" %}
Enumerate SNMPv2c Public
{% endhint %}

```bash
snmpwalk -v2c -c public $TARGET
```

#### [Onesixtyone](https://github.com/trailofbits/onesixtyone)

{% hint style="info" %}
Enumerate SNMP Public
{% endhint %}

```bash
onesixtyone -c /usr/share/seclists/Discovery/SNMP/common-snmp-community-strings.txt $TARGET
```

#### [Metasploit](https://github.com/rapid7/metasploit-framework)

{% hint style="info" %}
Enumerate SNMP Public
{% endhint %}

```bash
msfconsole -qx "
    use auxiliary/scanner/snmp/snmp_enum;
    set RHOSTS $WEBSITE;
    run;
    exit"
```

{% hint style="info" %}
Enumerate Windows Users
{% endhint %}

```bash
msfconsole -qx "
    use auxiliary/scanner/snmp/snmp_enumusers;
    set RHOSTS $WEBSITE;
    run;
    exit"
```

{% hint style="info" %}
Enumerate File Shares
{% endhint %}

```bash
msfconsole -qx "
    use auxiliary/scanner/snmp/snmp_enumshares;
    set RHOSTS $WEBSITE;
    run;
    exit"
```

### SMB

#### [Nmap](https://nmap.org/)

{% hint style="info" %}
Detect smb vulnerabilities
{% endhint %}

```bash
nmap -sS -sV --mtu 5000 \
--script=smb2-vuln-*,smb-vuln-*,samba-vuln-cve-2012-1182.nse,smb-double-pulsar-backdoor,smb-brute \
-p 139,445 $TARGET
```

#### [Metasploit](https://github.com/rapid7/metasploit-framework)

{% hint style="info" %}
Credential Brute Force
{% endhint %}

```bash
msfconsole -qx "
    use auxiliary/scanner/smb/smb_login;
    set RHOSTS $TARGET;
    set SMBUser Administrator;
    set PASS_FILE /usr/share/seclists/Passwords/Default-Credentials/default-passwords.txt;
    set STOP_ON_SUCCESS true;
    set ANONYMOUS_LOGIN true;
    set THREADS 10;
    run;
    exit"
```

{% hint style="info" %}
Detect EternalBlue
{% endhint %}

```bash
msfconsole -qx "
    use auxiliary/scanner/smb/smb_ms17_010;
    set RHOSTS $TARGET;
    run;
    exit"
```

#### [Nuclei](https://github.com/projectdiscovery/nuclei)

{% hint style="info" %}
Misconfiguration & Vulnerabilities
{% endhint %}

```bash
nuclei -tags smb -u $TARGET:445
```

### IMAP

#### [Nmap](https://nmap.org/)

{% hint style="info" %}
Detect IMAP vulnerabilities
{% endhint %}

```bash
nmap -sS -sV --mtu 5000 \
--script=imap-ntlm-info,imap-brute \
-p 143,993 $TARGET
```

### POP3

#### [Nmap](https://nmap.org/)

{% hint style="info" %}
Detect POP3 vulnerabilities
{% endhint %}

```bash
nmap -sS -sV --mtu 5000 \
--script=pop3-ntlm-info,pop3-brute \
-p 110,995 $TARGET
```

### RDP

#### [Nmap](https://nmap.org/)

{% hint style="info" %}
Detect RDP vulnerabilities
{% endhint %}

```bash
nmap -sS -sV --mtu 5000 \
     --script=rdp-vuln-ms12-020,rdp-ntlm-info \
     -p 3389 $TARGET
```

### Redis

#### [Nmap](https://nmap.org/)

{% hint style="info" %}
Detect Redis vulnerabilities
{% endhint %}

```bash
nmap -sS -sV --mtu 5000 \
--script=redis-info.nse \
-p 6379 $TARGET
```

#### [Metasploit](https://github.com/rapid7/metasploit-framework)

{% hint style="info" %}
Redis Misconfiguration Check
{% endhint %}

```bash
msfconsole -qx "use auxiliary/gather/redis_extractor;
    set RHOSTS $TARGET;
    run;
    exit"
```

#### [Nuclei](https://github.com/projectdiscovery/nuclei)

{% hint style="info" %}
Misconfiguration & Vulnerabilities
{% endhint %}

```bash
nuclei -tags redis -u $TARGET:6379
```

### Memcached

#### [Nmap](https://nmap.org/)

{% hint style="info" %}
Scan Memcached
{% endhint %}

```bash
nmap -p 11211 -sS -sV --mtu 5000 --script memcached-info $WEBSITE
```

#### [Nuclei](https://github.com/projectdiscovery/nuclei)

{% hint style="info" %}
Misconfiguration & Vulnerabilities
{% endhint %}

```bash
nuclei -tags memcached -u $TARGET:11211
```
